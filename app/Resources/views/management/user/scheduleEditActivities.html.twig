{% extends 'base.html.twig' %}

{% block sections %}
    <section>
        <header class="main">
            <h2>Cinéscénie du {{ cinescenie.date|localizeddate('none', 'none', null, null, 'EEEE d LLLL y') }}</h2>
        </header>

        {% for flash_message in app.session.flashBag.get('notice') %}
          <div class="box">
              <p>{{ flash_message }}</p>
          </div>
        {% endfor %}

        <h3>Planning</h3>

        <table>
            <thead>
                <tr>
                    <th>Rôle</th>
                    <th>Utilisateur</th>
                </tr>
            </thead>
            <tbody>
                {% for activity in activities %}
                    <tr>
                        <td>
                            <a href="{{ path('userScheduleEditActivity', {'cinescenie': cinescenie.id, 'activity': activity.id}) }}">{{ activity.name }}</a>
                        </td>
                        <td>
                            {% for schedule in schedules %}
                                {% if schedule.activity == activity %}
                                    {% if schedule.user.deleted %}
                                        {{ schedule.user.firstname }} {{ schedule.user.lastname }}
                                    {% else %}
                                        <a href="{{ path('userGeneral', {'userSlug': schedule.user.username}) }}">{{ schedule.user.firstname }} {{ schedule.user.lastname }}</a>
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <p>
            Personnes présentes sans rôle d'attribué :
            {% for schedule in schedules %}
                {% if schedule.activity is null %}
                    {% if schedule.user.deleted == 0 %}
                        <a href="{{ path('userGeneral', {'userSlug': schedule.user.username}) }}">{{ schedule.user.firstname }} {{ schedule.user.lastname }}</a> |
                    {% endif %}
                {% endif %}
            {% endfor %}
        </p>

        <div class="row uniform">
            <div class="12u$">
                <ul class="actions align-right">
                    <li><a href="{{ path('userSchedule') }}" class="button">Retour</a></li>
                </ul>
            </div>
        </div>
    </section>
{% endblock %}